<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Style Pricer V3 - è¶…å¯Œè£•å±¤å¯¾å¿œç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Noto Sans JP', sans-serif; }
        .card-selected {
            border: 2px solid #f59e0b !important;
            background-color: #fffbeb !important; /* amber-50 */
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(245, 158, 11, 0.2);
        }
        /* ã‚µãƒã‚¤ãƒãƒ«ç³»ã®è‰²ã¯é’ç™½ã */
        .card-selected[data-rank="0"], .card-selected[data-rank="1"] {
            border-color: #94a3b8 !important;
            background-color: #f1f5f9 !important;
            box-shadow: none;
        }
        /* é€šå¸¸ãƒ©ãƒ³ã‚¯ */
        .card-selected[data-rank="2"], .card-selected[data-rank="3"] {
            border-color: #0ea5e9 !important;
            background-color: #f0f9ff !important;
            box-shadow: 0 4px 6px -1px rgba(14, 165, 233, 0.3);
        }

        .card-option { transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); }
        .card-option:hover { transform: translateY(-2px); z-index: 10; }

        .detail-box { display: none; }
        .detail-box.show { display: block; animation: slideDown 0.3s ease-out; }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); max-height: 0; }
            to { opacity: 1; transform: translateY(0); max-height: 300px; }
        }
        .pb-safe { padding-bottom: 220px; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <header class="bg-slate-900 text-white p-4 sticky top-0 z-50 shadow-2xl">
        <div class="max-w-[1400px] mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <div>
                <h1 class="text-xl font-bold flex items-center">
                    <i class="fa-solid fa-scale-balanced text-amber-400 mr-2"></i>
                    Life Style Pricer
                    <span class="ml-2 text-[10px] bg-amber-500 text-black px-1.5 py-0.5 rounded font-bold">V3.1 (2024-2025ç‰ˆ)</span>
                </h1>
                <p class="text-[10px] text-slate-400">ã‚¤ãƒ³ãƒ•ãƒ¬ãƒ»å††å®‰åæ˜ æ¸ˆã¿ï¼šå…¨6ãƒ©ãƒ³ã‚¯æ¯”è¼ƒ</p>
            </div>
            <div class="flex gap-1 overflow-x-auto w-full md:w-auto pb-1 md:pb-0">
                <button onclick="setPreset('survival')" class="whitespace-nowrap text-[10px] bg-slate-700 hover:bg-slate-600 text-slate-300 px-3 py-2 rounded transition border border-slate-600">
                    <i class="fa-solid fa-skull mr-1"></i>é™ç•Œ
                </button>
                <button onclick="setPreset('standard')" class="whitespace-nowrap text-[10px] bg-sky-900 hover:bg-sky-800 text-white px-3 py-2 rounded transition">
                    <i class="fa-solid fa-user mr-1"></i>æ¨™æº–
                </button>
                <button onclick="setPreset('rich')" class="whitespace-nowrap text-[10px] bg-indigo-900 hover:bg-indigo-800 text-white px-3 py-2 rounded transition">
                    <i class="fa-solid fa-gem mr-1"></i>è´…æ²¢
                </button>
                <button onclick="setPreset('king')" class="whitespace-nowrap text-[10px] bg-gradient-to-r from-amber-400 via-yellow-500 to-amber-600 hover:brightness-110 text-white px-4 py-2 rounded transition shadow-lg font-bold border border-yellow-300">
                    <i class="fa-solid fa-crown mr-1"></i>çŸ³æ²¹ç‹
                </button>
            </div>
        </div>
    </header>

    <div class="max-w-[1400px] mx-auto p-2 md:p-6 grid grid-cols-1 xl:grid-cols-12 gap-6 pb-safe">

        <div class="xl:col-span-9 space-y-8" id="options-container">
            </div>

        <div class="xl:col-span-3">
            <div class="sticky top-24 bg-white rounded-2xl shadow-xl p-5 border border-slate-200 z-40">
                <div class="flex justify-between items-end mb-4 border-b pb-2">
                    <h2 class="text-lg font-bold text-slate-700">è¨ºæ–­çµæœ</h2>
                    <span class="text-[10px] text-slate-400">ç¨è¾¼ãƒ»å„ç¨®ä¿é™ºè¾¼</span>
                </div>

                <div class="space-y-3 mb-6">
                    <div class="bg-gradient-to-br from-slate-800 to-slate-900 p-4 rounded-xl text-white shadow-lg relative overflow-hidden group">
                        <div class="absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition">
                            <i class="fa-solid fa-yen-sign text-4xl"></i>
                        </div>
                        <p class="text-[10px] text-slate-300 mb-1">å¿…è¦ãªé¡é¢å¹´å</p>
                        <div class="flex items-baseline">
                            <span class="text-3xl font-bold text-amber-400" id="total-yearly">0</span>
                            <span class="text-xs text-slate-300 ml-1">ä¸‡å††</span>
                        </div>
                        <p class="text-[10px] text-red-300 mt-2 font-bold" id="tax-alert"></p>
                    </div>

                    <div class="bg-white border-2 border-slate-100 p-3 rounded-xl">
                        <p class="text-[10px] text-slate-500 mb-0">æœˆæ‰‹å–ã‚Šå¿…è¦é¡</p>
                        <div class="flex items-baseline">
                            <span class="text-2xl font-bold text-slate-800" id="total-monthly">0</span>
                            <span class="text-xs text-slate-500 ml-1">ä¸‡å††</span>
                        </div>
                    </div>
                </div>

                <div class="relative w-full h-40 mb-4">
                    <canvas id="costChart"></canvas>
                </div>

                <div class="text-center p-3 rounded-lg bg-slate-50 border border-slate-200 mb-4">
                    <p class="text-[10px] text-slate-400">Life Style Rank</p>
                    <p class="text-sm font-bold mt-1 leading-tight" id="rank-text">-</p>
                </div>

                <button onclick="copyResult()" class="w-full bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 rounded-xl transition flex justify-center items-center gap-2 text-xs shadow-md active:scale-95">
                    <i class="fa-regular fa-copy"></i> çµæœã‚’ã‚³ãƒ”ãƒ¼
                </button>
            </div>
        </div>
    </div>

    <div class="fixed bottom-0 left-0 w-full bg-white/90 backdrop-blur-md border-t border-slate-200 p-3 xl:hidden shadow-[0_-5px_20px_rgba(0,0,0,0.15)] z-50">
        <div class="flex justify-between items-center max-w-7xl mx-auto px-2">
            <div>
                <p class="text-[10px] text-slate-500">æ¨å®šé¡é¢å¹´å</p>
                <p class="text-2xl font-bold text-slate-900 leading-none"><span id="mobile-yearly">0</span><span class="text-xs font-normal">ä¸‡å††</span></p>
            </div>
            <div class="text-right mr-4">
                <p class="text-[10px] text-slate-500">æœˆæ‰‹å–ã‚Š</p>
                <p class="text-lg font-bold text-sky-600 leading-none"><span id="mobile-monthly">0</span><span class="text-xs font-normal text-slate-400">ä¸‡å††</span></p>
            </div>
            <button onclick="window.scrollTo({top:0, behavior: 'smooth'})" class="h-10 w-10 bg-slate-800 text-white rounded-full shadow-lg flex items-center justify-center hover:bg-slate-700 active:scale-90 transition">
                <i class="fa-solid fa-arrow-up"></i>
            </button>
        </div>
    </div>

    <script>
        // --- ãƒ‡ãƒ¼ã‚¿å®šç¾© (å…¨6ãƒ©ãƒ³ã‚¯: 0=é™ç•Œ, 1=ç¯€ç´„, 2=æ¨™æº–, 3=ä½™è£•, 4=å¯Œè£•, 5=è¶…å¯Œè£•) ---
        const categories = [
            {
                id: 'family',
                title: 'åŸºæœ¬ç”Ÿæ´»è²»ãƒ»å®¶æ—',
                desc: 'å…‰ç†±è²»ãƒ»é€šä¿¡ãƒ»æ¶ˆè€—å“ãƒ»ä¿é™ºãƒ»æ•™è‚²è²» (ã‚¤ãƒ³ãƒ•ãƒ¬åæ˜ )',
                icon: 'fa-users',
                options: [
                    { id: 'f0', rank:0, label: 'å®Ÿå®¶/å¯„ç”Ÿ', price: 2.5, icon: 'fa-people-roof',
                      detail: '<b>ã€å®¶ã«å…¥ã‚Œã‚ã€‘æœˆ2.5ä¸‡å††</b><br>å®Ÿå®¶ã§ã®é£Ÿè²»ãƒ»å…‰ç†±è²»è² æ‹…åˆ†ã€‚<br>é€šä¿¡ã¯æ ¼å®‰SIM(1500å††)ã€ã‚µãƒ–ã‚¹ã‚¯ã¯è§£ç´„ã€‚<br>ã€Œå€¤ä¸Šã’è¾›ã„ã€ãŒå£ç™–ã€‚' },
                    { id: 'f1', rank:1, label: 'ç‹¬èº«ãƒŸãƒ‹ãƒãƒ ', price: 10.5, icon: 'fa-user',
                      detail: '<b>ã€ç‰©ä¾¡é«˜ç›´æ’ƒã€‘æœˆ10.5ä¸‡å††</b><br>å…‰ç†±è²»: 1.5ä¸‡(é«˜é¨°)<br>é€šä¿¡: 1.0ä¸‡<br>æ—¥ç”¨å“: 3.0ä¸‡(å€¤ä¸Šã’)<br>ä¿é™ºãƒ»äºˆå‚™: 5.0ä¸‡<br>â€»æ€¥ãªå‡ºè²»ã§èµ¤å­—ã«ãªã‚‹ãƒ©ã‚¤ãƒ³ã€‚' },
                    { id: 'f2', rank:2, label: 'å¤«å©¦2äºº', price: 18.5, icon: 'fa-user-group',
                      detail: '<b>ã€å…±åƒãæ¨™æº–ã€‘æœˆ18.5ä¸‡å††</b><br>å…‰ç†±è²»: 3.0ä¸‡<br>é€šä¿¡: 2.0ä¸‡<br>ä¿é™ºãƒ»åŒ»ç™‚: 3.5ä¸‡<br>è¢«æœãƒ»é›‘è²»: 10.0ä¸‡<br>â€»ãƒ¦ãƒ‹ã‚¯ãƒ­ã‚‚å€¤ä¸ŠãŒã‚Šã—ã¦èºŠèº‡ã™ã‚‹ã€‚' },
                    { id: 'f3', rank:3, label: 'å­ä¾›1ã€œ2äºº', price: 30.0, icon: 'fa-children',
                      detail: '<b>ã€å­è‚²ã¦ä¸–å¸¯ã€‘æœˆ30.0ä¸‡å††</b><br>å…‰ç†±è²»: 4.5ä¸‡(å¤å†¬ã¯åœ°ç„)<br>æ•™è‚²ãƒ»ç¿’ã„äº‹: 6.0ä¸‡<br>ä¿é™ºãƒ»åŒ»ç™‚: 6.0ä¸‡<br>ãƒ¬ã‚¸ãƒ£ãƒ¼äºˆå‚™: 13.5ä¸‡<br>â€»ãŸã¾ã®ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ã‚‚ãƒã‚±ãƒƒãƒˆé«˜é¨°ã§ç—›æ‰‹ã€‚' },
                    { id: 'f4', rank:4, label: 'æ•™è‚²ç†±å¿ƒ', price: 55.0, icon: 'fa-graduation-cap',
                      detail: '<b>ã€ç§ç«‹ãƒ»ç•™å­¦ã€‘æœˆ55.0ä¸‡å††</b><br>ç§ç«‹å­¦è²»ãƒ»å¡¾: 25.0ä¸‡<br>å…‰ç†±è²»ãƒ»é€šä¿¡: 10.0ä¸‡<br>å®¶äº‹ä»£è¡Œ: 8.0ä¸‡<br>ãã®ä»–: 12.0ä¸‡<br>â€»æ•™è‚²è²»ã®ã‚¤ãƒ³ãƒ•ãƒ¬ãŒæ­¢ã¾ã‚‰ãªã„ã€‚' },
                    { id: 'f5', rank:5, label: 'VIP/åŸ·äº‹', price: 150.0, icon: 'fa-chess-queen',
                      detail: '<b>ã€ä½¿ç”¨äººä»˜ãã€‘æœˆ150ä¸‡å††ã€œ</b><br>ã‚·ãƒƒã‚¿ãƒ¼/å®¶æ”¿å©¦: 80ä¸‡<br>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒŠã‚·ãƒ§ãƒŠãƒ«ã‚¹ã‚¯ãƒ¼ãƒ«: 30ä¸‡<br>æ–½è¨­ç¶­æŒ(ãƒ—ãƒ¼ãƒ«ç­‰): 20ä¸‡<br>è­¦å‚™ãƒ»ã‚»ã‚³ãƒ : 20ä¸‡' }
                ]
            },
            {
                id: 'house',
                title: 'ä½ã¾ã„',
                desc: 'å®¶è³ƒã¾ãŸã¯ãƒ­ãƒ¼ãƒ³è¿”æ¸ˆé¡ (éƒ½å¿ƒéƒ¨ä¾¡æ ¼é«˜é¨°)',
                icon: 'fa-house',
                options: [
                    { id: 'h0', rank:0, label: 'è¨³ã‚ã‚Š', price: 3.5, icon: 'fa-dungeon',
                      detail: '<b>ã€é¢¨å‘‚ãªã—ã€‘æœˆ3.5ä¸‡å††</b><br>ç¯‰50å¹´æœ¨é€ ã€äº‹æ•…ç‰©ä»¶å«ã‚€ã€‚<br>ã¾ãŸã¯éƒŠå¤–ã‚·ã‚§ã‚¢ãƒã‚¦ã‚¹ã€‚<br>æ ¼å®‰ç‰©ä»¶ã¯ç«¶äº‰ç‡æ¿€åŒ–ã€‚' },
                    { id: 'h1', rank:1, label: 'éƒŠå¤–ã‚¢ãƒ‘ãƒ¼ãƒˆ', price: 7.0, icon: 'fa-building',
                      detail: '<b>ã€1Kãƒ»é§…é ã€‘æœˆ7.0ä¸‡å††</b><br>éƒ½å¿ƒã¾ã§1æ™‚é–“ã€‚<br>ãƒ¦ãƒ‹ãƒƒãƒˆãƒã‚¹ã€‚<br>æ›´æ–°æ–™ã¨å®¶è³ƒå€¤ä¸Šã’ã«ãŠã³ãˆã‚‹æ—¥ã€…ã€‚' },
                    { id: 'h2', rank:2, label: 'éƒ½å¸‚éƒ¨', price: 14.5, icon: 'fa-city',
                      detail: '<b>ã€1LDKã€‘æœˆ14.5ä¸‡å††</b><br>æ±äº¬23åŒºå†…ãƒãƒ³ã‚·ãƒ§ãƒ³ã€‚<br>ä»¥å‰ã¯12ä¸‡ã ã£ãŸãŒå€¤ä¸ŠãŒã‚Šã€‚<br>ç®¡ç†è²»ãƒ»ä¿®ç¹•ç©ç«‹é‡‘ã‚‚ä¸Šæ˜‡ä¸­ã€‚' },
                    { id: 'h3', rank:3, label: 'äººæ°—ã‚¨ãƒªã‚¢', price: 26.0, icon: 'fa-house-chimney',
                      detail: '<b>ã€2LDKã€œã€‘æœˆ26.0ä¸‡å††</b><br>ä¸–ç”°è°·ãƒ»ç›®é»’ã‚¨ãƒªã‚¢ã€‚<br>ãƒ•ã‚¡ãƒŸãƒªãƒ¼ç‰©ä»¶ã¯äº‰å¥ªæˆ¦ã€‚<br>7000ä¸‡ã€œã®ãƒ­ãƒ¼ãƒ³è¿”æ¸ˆç›¸å½“ã€‚' },
                    { id: 'h4', rank:4, label: 'ã‚¿ãƒ¯ãƒãƒ³', price: 55.0, icon: 'fa-hotel',
                      detail: '<b>ã€é«˜å±¤éšã€‘æœˆ55.0ä¸‡å††</b><br>æ¸¯åŒºãƒ»æ¹¾å²¸ã‚¨ãƒªã‚¢ã€‚<br>å®¶è³ƒç›¸å ´ã¯é’å¤©äº•ã€‚<br>å…±ç›Šè²»ã ã‘ã§åœ°æ–¹ã®å®¶è³ƒä¸¦ã¿ã€‚<br>æµ·å¤–å¯Œè£•å±¤ãŒéš£äººã€‚' },
                    { id: 'h5', rank:5, label: 'è±ªé‚¸/åˆ¥è˜', price: 250.0, icon: 'fa-chess-rook',
                      detail: '<b>ã€è¦å¡ã€‘æœˆ250ä¸‡å††ç›¸å½“</b><br>åºƒå°¾ãƒ»éº»å¸ƒã®ä½å±¤ãƒ¬ã‚¸ãƒ‡ãƒ³ã‚¹<br>è»½äº•æ²¢ã¨ã®2æ‹ ç‚¹ç”Ÿæ´»ã€‚<br>å›ºå®šè³‡ç”£ç¨ã ã‘ã§é«˜ç´šè»ŠãŒè²·ãˆã‚‹ã€‚<br>åœ°ä¸‹é§è»Šå ´å®Œå‚™ã€‚' }
                ]
            },
            {
                id: 'car',
                title: 'ç§»å‹•æ‰‹æ®µ',
                desc: 'è»Šä¸¡ä»£ãƒ»é§è»Šå ´ãƒ»ç¶­æŒè²» (ã‚¬ã‚½ãƒªãƒ³é«˜)',
                icon: 'fa-car',
                options: [
                    { id: 'c0', rank:0, label: 'å¾’æ­©', price: 0, icon: 'fa-person-walking',
                      detail: '<b>ã€0å††ã€‘</b><br>ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼ã‚‚å€¤ä¸Šã’ã—ãŸãŒæˆ‘æ…¢ã€‚<br>ç§»å‹•ã¯åŸºæœ¬è‡ªåˆ†ã®è¶³ã€‚<br>é›¨ã®æ—¥ã¯å¤–å‡ºã—ãªã„ã€‚' },
                    { id: 'c1', rank:1, label: 'é›»è»Šã®ã¿', price: 1.5, icon: 'fa-train',
                      detail: '<b>ã€é‹è³ƒå€¤ä¸Šã€‘æœˆ1.5ä¸‡å††</b><br>é‰„é“é‹è³ƒã‚‚æ”¹å®šãƒ©ãƒƒã‚·ãƒ¥ã€‚<br>ã‚¿ã‚¯ã‚·ãƒ¼ã¯æ·±å¤œå‰²å¢—ãŒæ€–ãã¦ä¹—ã‚Œãªã„ã€‚<br>ãƒã‚¹ç§»å‹•ãŒãƒ¡ã‚¤ãƒ³ã€‚' },
                    { id: 'c2', rank:2, label: 'è»½/ä¸­å¤', price: 5.5, icon: 'fa-car-side',
                      detail: '<b>ã€ç”Ÿæ´»ã®è¶³ã€‘æœˆ5.5ä¸‡å††</b><br>è»Šä¸¡ä»£: 2.0ä¸‡(ä¸­å¤é«˜é¨°)<br>é§è»Šå ´: 1.5ä¸‡<br>ã‚¬ã‚½ãƒªãƒ³ãƒ»ç¨: 2.0ä¸‡<br>â€»ã‚¬ã‚½ãƒªãƒ³ä»£è£œåŠ©çµ‚äº†ãŒç—›ã„ã€‚' },
                    { id: 'c3', rank:3, label: 'æ–°è»ŠSUV', price: 11.0, icon: 'fa-car',
                      detail: '<b>ã€ã“ã ã‚ã‚Šã€‘æœˆ11.0ä¸‡å††</b><br>è»Šä¸¡: 5.0ä¸‡(ãƒãƒªã‚¢ãƒ¼ç­‰å€¤ä¸Š)<br>é§è»Šå ´: 3.0ä¸‡<br>ç¶­æŒè²»: 3.0ä¸‡<br>â€»ã‚¿ã‚¤ãƒ¤äº¤æ›ä»£ã‚‚é¦¬é¹¿ã«ãªã‚‰ãªã„ã€‚' },
                    { id: 'c4', rank:4, label: 'é«˜ç´šè»Š', price: 30.0, icon: 'fa-gem',
                      detail: '<b>ã€ãƒ™ãƒ³ãƒ„/BMWã€‘æœˆ30.0ä¸‡å††</b><br>è»Šä¸¡: 18.0ä¸‡<br>éƒ½å¿ƒé§è»Šå ´: 7.0ä¸‡<br>ç¶­æŒè²»: 5.0ä¸‡<br>â€»å††å®‰ã§è¼¸å…¥è»Šä¾¡æ ¼ãŒé«˜é¨°ã€‚' },
                    { id: 'c5', rank:5, label: 'ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚«ãƒ¼', price: 100.0, icon: 'fa-jet-fighter',
                      detail: '<b>ã€ãƒ•ã‚§ãƒ©ãƒ¼ãƒªä»–ã€‘æœˆ100ä¸‡å††ã€œ</b><br>ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ç¶­æŒã€‚<br>é‹è»¢æ‰‹(å¤–æ³¨): 50ä¸‡<br>ä¿é™ºãƒ»ãƒ¡ãƒ³ãƒ†: 20ä¸‡<br>ç©ºèª¿ã‚¬ãƒ¬ãƒ¼ã‚¸: 30ä¸‡' }
                ]
            },
            {
                id: 'food',
                title: 'é£Ÿäº‹ãƒ»è¶£å‘³',
                desc: 'é£Ÿè²»ï¼‹ãŠå°é£ã„ (é£Ÿæãƒ»å¤–é£Ÿè²»é«˜é¨°)',
                icon: 'fa-utensils',
                options: [
                    { id: 'fd0', rank:0, label: 'ç”Ÿå‘½ç¶­æŒ', price: 2.5, icon: 'fa-bone',
                      detail: '<b>ã€å€¤ä¸Šã’åœ°ç„ã€‘æœˆ2.5ä¸‡å††</b><br>ãƒ‘ã‚¹ã‚¿ã‚‚åµã‚‚å€¤ä¸ŠãŒã‚Šã€‚<br>ã‚‚ã‚„ã—ã¨è±†è…ãŒä¸»é£Ÿã€‚<br>æ¥­å‹™ç”¨ã‚¹ãƒ¼ãƒ‘ãƒ¼ã ã‘ãŒå‘³æ–¹ã€‚' },
                    { id: 'fd1', rank:1, label: 'è‡ªç‚Šç¯€ç´„', price: 5.5, icon: 'fa-carrot',
                      detail: '<b>ã€å¼å½“ç”·å­ã€‘æœˆ5.5ä¸‡å††</b><br>ã‚³ãƒ³ãƒ“ãƒ‹å¼å½“ã¯é«˜ç´šå“(700å††è¶…)ã€‚<br>è‡ªç‚Šã—ã¦ã‚‚é£ŸæãŒé«˜ã„ã€‚<br>ãƒã‚¤æ´»ã§å‡Œãã€‚' },
                    { id: 'fd2', rank:2, label: 'ãŸã¾ã«å¤–é£Ÿ', price: 10.5, icon: 'fa-beer-mug-empty',
                      detail: '<b>ã€é€±1é£²ã¿ä¼šã€‘æœˆ10.5ä¸‡å††</b><br>é£Ÿè²»: 6.5ä¸‡<br>è¶£å‘³ãƒ»äº¤éš›: 4.0ä¸‡<br>â€»å±…é…’å±‹ã‚‚å®¢å˜ä¾¡5000å††æ™‚ä»£ã€‚<br>ã‚µãƒ–ã‚¹ã‚¯å³é¸ãŒå¿…è¦ã€‚' },
                    { id: 'fd3', rank:3, label: 'ã‚°ãƒ«ãƒ¡', price: 20.0, icon: 'fa-wine-glass',
                      detail: '<b>ã€ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ä¾¡æ ¼ã€‘æœˆ20.0ä¸‡å††</b><br>é£Ÿè²»: 10.0ä¸‡<br>è¶£å‘³ãƒ»ç¾å®¹: 10.0ä¸‡<br>â€»ãƒ©ãƒ³ãƒ2000å††ãŒå½“ãŸã‚Šå‰ã€‚<br>ãƒ‡ãƒ‘ã‚³ã‚¹ã‚‚å€¤ä¸Šã’ãƒ©ãƒƒã‚·ãƒ¥ã€‚' },
                    { id: 'fd4', rank:4, label: 'ç¾é£Ÿå®¶', price: 50.0, icon: 'fa-champagne-glasses',
                      detail: '<b>ã€æ¯æ—¥å¤–é£Ÿã€‘æœˆ50.0ä¸‡å††</b><br>è¥¿éº»å¸ƒãƒ»éŠ€åº§ã®ã‚³ãƒ¼ã‚¹ã¯3ä¸‡ã€œã€‚<br>äºˆç´„å›°é›£åº—ã¯ã•ã‚‰ã«é«˜é¨°ã€‚<br>ç¾å®¹åŒ»ç™‚ã«æœˆ10ä¸‡ã€‚' },
                    { id: 'fd5', rank:5, label: 'å°‚å±ã‚·ã‚§ãƒ•', price: 200.0, icon: 'fa-martini-glass-citrus',
                      detail: '<b>ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã€‘æœˆ200ä¸‡å††ã€œ</b><br>å‡ºå¼µã‚·ã‚§ãƒ•/ä¼šå“¡åˆ¶ã‚¯ãƒ©ãƒ–ã€‚<br>ãƒ¯ã‚¤ãƒ³1æœ¬20ä¸‡ã€œã€‚<br>æµ·å¤–æ—…è¡Œã¯ç‡ƒæ²¹é«˜ã§ã‚‚ãƒ“ã‚¸ãƒã‚¹ã‚¯ãƒ©ã‚¹ã€‚' }
                ]
            },
            {
                id: 'invest',
                title: 'æŠ•è³‡ãƒ»è²¯é‡‘',
                desc: 'å°†æ¥ã¸ã®å‚™ãˆ (æ–°NISAå¯¾å¿œ)',
                icon: 'fa-piggy-bank',
                options: [
                    { id: 'i0', rank:0, label: 'å€Ÿé‡‘', price: -3.0, icon: 'fa-ban',
                      detail: '<b>ã€è‡ªè»¢è»Šæ“æ¥­ã€‘èµ¤å­—3.0ä¸‡å††</b><br>ç”Ÿæ´»è²»ä¸è¶³ã‚’ã‚«ãƒ¼ãƒ‰ã§è£œå¡«ã€‚<br>é‡‘åˆ©è² æ‹…ãŒé‡ãã®ã—ã‹ã‹ã‚‹ã€‚<br>è²¯é‡‘ã¯å¤¢ã®ã¾ãŸå¤¢ã€‚' },
                    { id: 'i1', rank:1, label: 'ãªã—', price: 0, icon: 'fa-wallet',
                      detail: '<b>ã€ãƒ—ãƒ©ãƒã‚¤ã‚¼ãƒ­ã€‘0å††</b><br>çµ¦æ–™æ—¥å‰ã¯ã‚‚ã‚„ã—ç”Ÿæ´»ã€‚<br>ã€Œè€å¾Œ2000ä¸‡ï¼Ÿç„¡ç†ã€<br>ç¾çŠ¶ç¶­æŒã§ç²¾ä¸€æ¯ã€‚' },
                    { id: 'i2', rank:2, label: 'æ–°NISA', price: 10.0, icon: 'fa-coins',
                      detail: '<b>ã€ã¤ã¿ãŸã¦æ æº€é¡ã€‘æœˆ10.0ä¸‡å††</b><br>æ–°NISAã¤ã¿ãŸã¦æ (æœˆ10ä¸‡)ã‚’åŸ‹ã‚ã‚‹ã€‚<br>å°†æ¥ã®ã‚¤ãƒ³ãƒ•ãƒ¬ãƒ˜ãƒƒã‚¸ã€‚<br>å …å®Ÿãªè³‡ç”£å½¢æˆã®ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã€‚' },
                    { id: 'i3', rank:3, label: 'è³‡ç”£å½¢æˆ', price: 20.0, icon: 'fa-money-bill-trend-up',
                      detail: '<b>ã€æˆé•·æ æ´»ç”¨ã€‘æœˆ20.0ä¸‡å††</b><br>ã¤ã¿ãŸã¦+æˆé•·æ ã€‚<br>iDeCoã‚‚ä½µç”¨ã€‚<br>ãƒã‚¹å±¤ã‹ã‚‰ã®è„±å‡ºã‚’ç›®æŒ‡ã™ã€‚' },
                    { id: 'i4', rank:4, label: 'FIREç‹™ã„', price: 50.0, icon: 'fa-sack-dollar',
                      detail: '<b>ã€çµ¦æ–™ã®åŠåˆ†ã€‘æœˆ50.0ä¸‡å††</b><br>å¹´é–“600ä¸‡å††æŠ•è³‡ã€‚<br>ã‚¤ãƒ³ãƒ•ãƒ¬ã«è² ã‘ãªã„è³‡ç”£ä½œã‚Šã€‚<br>é…å½“é‡‘ç”Ÿæ´»ã¸ã®æœ€çŸ­ãƒ«ãƒ¼ãƒˆã€‚' },
                    { id: 'i5', rank:5, label: 'æŠ•è³‡å®¶', price: 500.0, icon: 'fa-hand-holding-dollar',
                      detail: '<b>ã€äº‹æ¥­æŠ•è³‡ã€‘æœˆ500ä¸‡å††ã€œ</b><br>ã‚¨ãƒ³ã‚¸ã‚§ãƒ«æŠ•è³‡ã€ä¸å‹•ç”£ã€‚<br>è³‡ç”£ãŒè³‡ç”£ã‚’ç”Ÿã‚€ã‚µã‚¤ã‚¯ãƒ«ã€‚<br>ç›¸ç¶šç¨å¯¾ç­–ãŒè‡³ä¸Šå‘½é¡Œã€‚' }
                ]
            }
        ];

        let selections = {};
        let chartInstance = null;

        function init() {
            const container = document.getElementById('options-container');

            categories.forEach(cat => {
                selections[cat.id] = cat.options[2]; // åˆæœŸå€¤ï¼šæ¨™æº–

                const section = document.createElement('div');
                section.className = "bg-white p-4 md:p-6 rounded-2xl shadow-sm border border-slate-200";

                // ãƒ˜ãƒƒãƒ€ãƒ¼
                const header = document.createElement('div');
                header.className = "flex items-center gap-3 mb-4";
                header.innerHTML = `
                    <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 text-xl">
                        <i class="fa-solid ${cat.icon}"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-slate-800 text-base">${cat.title}</h3>
                        <p class="text-[10px] text-slate-400">${cat.desc}</p>
                    </div>
                `;
                section.appendChild(header);

                // ã‚°ãƒªãƒƒãƒ‰ (6ã¤ãªã®ã§ 2åˆ—x3è¡Œ or 3åˆ—x2è¡Œ)
                const grid = document.createElement('div');
                grid.className = "grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-6 gap-3";

                cat.options.forEach(opt => {
                    const btn = document.createElement('div');
                    btn.className = `card-option group relative bg-white border border-slate-200 rounded-xl p-2 cursor-pointer flex flex-col justify-between h-full hover:border-slate-300`;
                    btn.dataset.rank = opt.rank;
                    btn.id = `btn-${cat.id}-${opt.id}`;
                    btn.onclick = (e) => {
                        if(e.target.closest('.detail-btn')) return;
                        selectOption(cat.id, opt);
                    };

                    // ã‚«ãƒ¼ãƒ‰ã®ä¸­èº«
                    let priceDisplay = opt.price >= 0 ? opt.price.toFixed(1) : `<span class="text-red-500">${opt.price.toFixed(1)}</span>`;

                    btn.innerHTML = `
                        <div class="text-center pt-2 pb-1">
                            <div class="text-xl mb-1 text-slate-300 group-hover:text-slate-500 transition-colors">
                                <i class="fa-solid ${opt.icon}"></i>
                            </div>
                            <div class="text-[11px] font-bold text-slate-600 leading-tight mb-1">${opt.label}</div>
                            <div class="text-base font-bold text-slate-800">${priceDisplay}<span class="text-[10px] font-normal text-slate-400 ml-0.5">ä¸‡</span></div>
                        </div>

                        <button onclick="toggleDetail('${cat.id}', '${opt.id}')" class="detail-btn mt-2 w-full py-1.5 bg-slate-50 hover:bg-slate-100 rounded-lg text-[10px] text-slate-500 font-medium transition flex items-center justify-center gap-1">
                            <i class="fa-solid fa-circle-info"></i> è©³ç´°
                        </button>

                        <div id="detail-${cat.id}-${opt.id}" class="detail-box absolute top-full left-0 z-50 w-64 bg-white border border-slate-200 rounded-lg shadow-xl p-3 text-xs text-slate-600 text-left mt-2 hidden">
                            <div class="mb-1">${opt.detail}</div>
                            <div class="text-[10px] text-right text-sky-500 cursor-pointer underline" onclick="this.parentElement.style.display='none'">é–‰ã˜ã‚‹</div>
                        </div>
                    `;
                    grid.appendChild(btn);
                });

                section.appendChild(grid);
                container.appendChild(section);
            });

            // å¤–éƒ¨ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ã‚’é–‰ã˜ã‚‹
            document.addEventListener('click', (e) => {
                if(!e.target.closest('.card-option')) {
                    document.querySelectorAll('.detail-box').forEach(el => {
                        el.style.display = 'none';
                        el.classList.remove('show');
                    });
                }
            });

            updateUI();
        }

        function selectOption(catId, option) {
            selections[catId] = option;
            updateUI();
        }

        function toggleDetail(catId, optId) {
            // ä»–ã‚’é–‰ã˜ã‚‹
            document.querySelectorAll('.detail-box').forEach(el => {
                if(el.id !== `detail-${catId}-${optId}`) {
                    el.style.display = 'none';
                    el.classList.remove('show');
                }
            });

            const box = document.getElementById(`detail-${catId}-${optId}`);
            if(box.style.display === 'block') {
                box.style.display = 'none';
                box.classList.remove('show');
            } else {
                box.style.display = 'block';
                box.classList.add('show');

                // ç”»é¢ç«¯ã®èª¿æ•´ï¼ˆç°¡æ˜“ç‰ˆï¼‰
                const rect = box.parentElement.getBoundingClientRect();
                if(rect.right > window.innerWidth) {
                    box.style.left = 'auto';
                    box.style.right = '0';
                } else {
                    box.style.left = '0';
                    box.style.right = 'auto';
                }
            }
        }

        function setPreset(type) {
            categories.forEach(cat => {
                let idx = 2; // default
                if (type === 'survival') idx = 0;
                else if (type === 'min') idx = 1; // standard button name conflict fix
                else if (type === 'standard') idx = 2;
                else if (type === 'rich') idx = 3; // "è´…æ²¢"
                else if (type === 'king') idx = 5; // Max
                selections[cat.id] = cat.options[idx] || cat.options[cat.options.length-1];
            });
            updateUI();
        }

        function updateUI() {
            // ã‚¹ã‚¿ã‚¤ãƒ«
            document.querySelectorAll('.card-option').forEach(el => el.classList.remove('card-selected'));
            for(const [id, opt] of Object.entries(selections)){
                const btn = document.getElementById(`btn-${id}-${opt.id}`);
                if(btn) btn.classList.add('card-selected');
            }

            // è¨ˆç®—
            let monthlyNet = 0;
            let data = [];
            let labels = [];

            categories.forEach(cat => {
                const price = selections[cat.id].price;
                monthlyNet += price;
                labels.push(cat.title.substring(0, 4));
                data.push(Math.max(0, price)); // ã‚°ãƒ©ãƒ•ç”¨ã«ãƒã‚¤ãƒŠã‚¹ã¯0æ‰±ã„
            });

            monthlyNet = parseFloat(monthlyNet.toFixed(1));

            // å¹´åé€†ç®—ï¼ˆè¶…é«˜æ‰€å¾—å¯¾å¿œï¼‰
            // å®ŸåŠ¹ç¨ç‡ã‚’æ„è­˜ã—ãŸã‚«ãƒ¼ãƒ–
            let m = 1.25;
            if(monthlyNet > 20) m = 1.30;
            if(monthlyNet > 40) m = 1.40;
            if(monthlyNet > 70) m = 1.50;
            if(monthlyNet > 100) m = 1.65; // å¹´å2000ä¸‡ç´š
            if(monthlyNet > 200) m = 1.85; // å¹´å4500ä¸‡ç´š
            if(monthlyNet > 400) m = 2.00; // å„„è¶…ãˆ (åŠåˆ†ç¨é‡‘)

            const yearly = Math.round(monthlyNet * 12 * m);

            // è¡¨ç¤º
            document.getElementById('total-monthly').innerText = monthlyNet.toLocaleString(undefined, {minimumFractionDigits: 1});
            document.getElementById('total-yearly').innerText = yearly.toLocaleString();
            document.getElementById('mobile-monthly').innerText = monthlyNet.toLocaleString(undefined, {minimumFractionDigits: 1});
            document.getElementById('mobile-yearly').innerText = yearly.toLocaleString();

            const rankEl = document.getElementById('rank-text');
            const alertEl = document.getElementById('tax-alert');
            alertEl.innerText = "";

            if(yearly < 400) {
                rankEl.innerText = "ğŸ’€ é™ç•Œã‚µãƒã‚¤ãƒãƒ¼";
                rankEl.className = "text-sm font-bold mt-1 text-slate-500";
            } else if(yearly < 700) {
                rankEl.innerText = "ğŸŒ± ä¸€èˆ¬å¸‚æ°‘";
                rankEl.className = "text-sm font-bold mt-1 text-green-600";
            } else if(yearly < 1200) {
                rankEl.innerText = "âœ¨ ãƒ—ãƒè´…æ²¢å±¤";
                rankEl.className = "text-sm font-bold mt-1 text-sky-600";
            } else if(yearly < 2500) {
                rankEl.innerText = "ğŸ’ ã‚¢ãƒƒãƒ‘ãƒ¼å±¤";
                rankEl.className = "text-sm font-bold mt-1 text-indigo-600";
                alertEl.innerText = "â€»æ‰€å¾—ç¨ç‡33%ã€œ40%ã‚¾ãƒ¼ãƒ³çªå…¥";
            } else if(yearly < 6000) {
                rankEl.innerText = "ğŸ‘‘ å¯Œè£•å±¤";
                rankEl.className = "text-sm font-bold mt-1 text-purple-600";
                alertEl.innerText = "â€»ç¨¼ãã®45%ä»¥ä¸ŠãŒç¨é‡‘ç­‰ã§æ¶ˆãˆã¾ã™";
            } else {
                rankEl.innerText = "ğŸ¦ çŸ³æ²¹ç‹ãƒ»å›½å®¶äºˆç®—ç´š";
                rankEl.className = "text-sm font-bold mt-1 text-amber-500 drop-shadow-sm";
                alertEl.innerText = "â€»ç¨é‡‘ã ã‘ã§å®¶ãŒå»ºã¡ã¾ã™";
            }

            updateChart(labels, data);
        }

        function updateChart(labels, data){
            const ctx = document.getElementById('costChart').getContext('2d');
            if(chartInstance) chartInstance.destroy();

            chartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: ['#64748b', '#0ea5e9', '#f59e0b', '#f43f5e', '#10b981'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    cutout: '75%'
                }
            });
        }

        function copyResult(){
            const y = document.getElementById('total-yearly').innerText;
            const m = document.getElementById('total-monthly').innerText;
            const r = document.getElementById('rank-text').innerText;
            const text = `ç§ã®ç†æƒ³ã®äººç”Ÿä¾¡æ ¼ï¼š\nå¹´åã€${y}ä¸‡å††ã€‘(æ‰‹å–ã‚Šæœˆ${m}ä¸‡)\nãƒ©ãƒ³ã‚¯ï¼š${r}\n#LifeStylePricer`;
            navigator.clipboard.writeText(text).then(()=>alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ'));
        }

        window.onload = init;
    </script>
</body>
</html>
